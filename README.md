#linux_qq
运行于linux上的命令行即时通讯程序<br>

###编译运行
* 编译<br>
	* 进入`client`和`server`目录，分别运行`make`<br>
* 运行<br>
	* 首先运行`server`, 进入`server`目录, 运行命令`./server`<br>
	* 再运行`client`, 进入`client`目录, 运行命令`./client xx.xx.xx.xx`<br>
	* `xx.xx.xx.xx`代表`服务器程序所在机器的ip地址`<br>

###已有功能
* [注册]<br>
	* 运行客户端,选择`1`,按照提示输入`用户名`和`密码`<br>
* [登录]<br>
	* 运行客户端,选择`0`,按照提示输入`用户名`和`密码`<br>
* [发送消息]<br>
	* 请按照这个格式发送你的消息`to:对方的用户名:消息内容`<br>
	* `to`代表发送消息命令<br>
	* `:`是英文冒号，作为分隔符<br>
* [发送文件]<br>
	* 命令格式为`fto:对方的用户名:文件路径`<br>
	* `fto`代表请求发送文件命令<br>
	* `文件路径`必须是合法的unix文件路径形式，例如:`/home/wugui/data`或`../data`<br>
	* 该命令支持`目录传输`<br>
* [同意接收文件]<br>
	* 首先进入`client`目录，建立接收文件的根目录:`mkdir data`<br>
	* 命令格式为`fok:文件发送方的用户名:文件名`<br>
	* 接收到的文件存放在`client/data/`目录下<br>
	* 如果待接收的文件已经在data目录下，将导致接收失败<br>
* [拒绝接收文件]<br>
	* 命令格式为`fno:文件发送方的用户名:文件名`<br>
* [查看好友列表]<br>
	* 命令`list`<br>
* [请求添加好友]<br>
	* 命令格式`add:用户名`<br>
* [同意添加好友]<br>
	* 命令格式`addok:请求方的用户名`<br>
* [拒绝添加好友]<br>
	* 命令格式`addno:请求方的用户名`<br>

###代码文件功能
* `msg_buffer.h`定义了向socket写入消息和从socket读出消息的缓冲队列<br>
* `util.h`声明了创建socket,设置epoll_event的帮助函数<br>
* `msg_util.h`定义了封装消息和拆解消息的接口<br>
* `ring_queue.h`定义了用于生产者-消费者问题的循环队列<br>
* `const.h`声明了所有常量<br>
* `server/`目录<br>
	* `server.cpp`包含了服务器的逻辑实现,添加新功能只需要修改do_service()函数和service.h中对应的接口即可<br>
	* `service.h`定义了服务器程序的服务接口<br>
	* `db.h`定义了服务器需要使用的表，这些表用来模拟数据库表<br>
	* `registed`文件保存了注册用户信息<br>
	* `friendship`文件保存了好友关系<br>
* `client/`目录<br>
	* `user_input_util.h`定义了提取用户输入的接口<br>
	* `fsocket.h`定义了传输文件的接口.文件传输的过程与tcp协议通信过程类似,分成建立连接,文件内容传输,断开连接.<br>
	* `client.cpp`包含了客户端的逻辑<br>
		* 客户端使用select函数处理三类io事件: 用户输入,网络输入,网络输出<br>
		* 开辟子线程负责文件发送或接收<br>
		* 文件发送和主线程发送消息是一个`互斥访问`消息缓冲的问题<br>
		* 接收文件是一个生产者-消费者问题: 主线程将接收到的文件消息发送到队列,子线程从队列读出消息并将消息内容写入对应文件<br>
